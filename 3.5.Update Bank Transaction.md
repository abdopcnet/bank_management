# Case 4: Update Bank Transaction

## Scenario Example:

-   ❌ Bank Transaction missing `reference_number`
-   ❌ Bank Transaction missing `party`
-   ✅ Goal: Update Bank Transaction to enable auto-reconcile

---

## Steps:

1. **Open Dialog**: Click "Actions" on the Bank Transaction

2. **Select Action**:

    - `action`: **"Update Bank Transaction"**

3. **Update Fields**:

    - `reference_number`: Enter reference number (e.g., "CHQ-001")
    - `party_type`: Select party type (Customer/Supplier)
    - `party`: Select party name

4. **Click "Reconcile"**:
    - Function called: `update_bank_transaction()`
    - System updates Bank Transaction fields
    - **Result**: Bank Transaction updated, can now be auto-reconciled

---

## Summary Table: When to Use Each Option

| Case         | Scenario                                               | Action                                      | Result                                     |
| ------------ | ------------------------------------------------------ | ------------------------------------------- | ------------------------------------------ |
| **Case 1A**  | One voucher exists matching Bank Transaction           | Match Against Voucher (select one)          | Links one voucher                          |
| **Case 1B**  | Multiple vouchers exist (one check = multiple entries) | Match Against Voucher (select multiple)     | Links multiple vouchers to one transaction |
| **Case 2**   | Deposit/Withdrawal with party, no voucher              | Create Voucher → Payment Entry              | Creates and matches Payment Entry          |
| **Case 3**   | Bank charges/fees, no party, no voucher                | Create Voucher → Journal Entry              | Creates and matches Journal Entry          |
| **Case 3F1** | Periodic account fees (monthly/annual)                 | Create Voucher → Journal Entry              | Creates and matches Journal Entry          |
| **Case 3F2** | Random account fees (penalties/unexpected)             | Create Voucher → Journal Entry              | Creates and matches Journal Entry          |
| **Case 3F3** | Transaction fees (on deposit/withdrawal with party)    | Payment Entry (party) + Journal Entry (fee) | Creates both vouchers and matches          |
| **Case 4**   | Missing reference_number or party in Bank Transaction  | Update Bank Transaction                     | Updates fields for auto-reconcile          |

### Examples for Case 1B (Multiple Vouchers Matching):

| Bank Transaction         | Recorded Vouchers                              | Action                | Result                                        |
| ------------------------ | ---------------------------------------------- | --------------------- | --------------------------------------------- |
| Deposit 2000, ref=123123 | PE1: 1000, ref=123123<br>PE2: 1000, ref=123123 | Select both PE1 & PE2 | ✅ Fully reconciled (2000)                    |
| Deposit 2000, ref=123123 | PE1: 800, ref=123123<br>PE2: 1200, ref=123123  | Select both PE1 & PE2 | ✅ Fully reconciled (2000)                    |
| Deposit 2000, ref=123123 | PE1: 1500, ref=123123<br>PE2: 1000, ref=123123 | Select PE1 only       | ⚠️ Partially reconciled (1500), 500 remaining |
| Deposit 2000, ref=123123 | PE1: 1500, ref=123123<br>PE2: 1000, ref=123123 | Select both PE1 & PE2 | ✅ Fully reconciled (2000)                    |
