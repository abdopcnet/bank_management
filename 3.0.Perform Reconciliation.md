# Perform Reconciliation

## Setup Reconciliation Screen

**Path**: `Accounting → Bank Reconciliation Tool`

**Required Fields**:

-   `company`
-   `bank_account`
-   `bank_statement_from_date`: Bank statement start date
-   `bank_statement_to_date`: Bank statement end date
-   `bank_statement_closing_balance`: **Closing balance from bank statement**

**Additional Options**:

-   `filter_by_reference_date`: Checkbox
    -   If enabled: Uses `from_reference_date` and `to_reference_date` instead of `bank_statement_from_date/to_date`

**Automatic Fields (read-only)**:

-   `account_currency`: From bank_account → account → account_currency
-   `account_opening_balance`: Auto-calculated until `bank_statement_from_date - 1 day`

---

## Auto Reconcile

**Button**: "Auto Reconcile"

**Python Function**: `erpnext.accounts.doctype.bank_reconciliation_tool.bank_reconciliation_tool.auto_reconcile_vouchers`

**Parameters Sent**:

-   `bank_account`
-   `from_date`: `bank_statement_from_date`
-   `to_date`: `bank_statement_to_date`
-   `filter_by_reference_date`
-   `from_reference_date`
-   `to_reference_date`

**Auto Reconcile Conditions** (mandatory):

1. `reference_number` in Bank Transaction = `reference_no` in Payment Entry
    - Or `reference_number` = `cheque_no` in Journal Entry
2. Date within range:
    - If `filter_by_reference_date = False`: `posting_date` between `from_date` and `to_date`
    - If `filter_by_reference_date = True`: `reference_date`/`cheque_date` between `from_reference_date` and `to_reference_date`
3. `payment_type` matches (Receive for deposit, Pay for withdrawal)
4. `clearance_date = NULL` (not reconciled previously)

**Result**: Message with number of reconciled transactions

---

## Manual Match

**Button**: "Get Unreconciled Entries"

**Steps**:

1. Click "Get Unreconciled Entries"
2. Statistics cards appear:
    - Bank Statement Balance (from `bank_statement_closing_balance`)
    - Cleared Balance (auto-calculated)
    - Difference (should = 0)
3. In `reconciliation_tool_dt` table, click "Actions" button on transaction
4. Dialog opens: "Reconcile Bank Transaction"

---

## Dialog: Reconcile Bank Transaction

**Open**: Click "Actions" on any unreconciled transaction

**Dialog shows**:

-   Transaction details (read-only): Date, Deposit, Withdrawal, Description, Allocated Amount, Unallocated Amount
-   Action dropdown: 3 options
